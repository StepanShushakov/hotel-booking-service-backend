# Hotel Booking Service

## Описание проекта
Проект представляет собой бэкенд для сервиса бронирования отелей с административной панелью для управления контентом. Основные функции включают поиск и бронирование отелей, управление пользователями и сбор статистики.

## Стек технологий
- **Java** (Spring Framework)
- **Spring Boot**, **Spring MVC**, **Spring Data JPA**
- **Lombok** – для генерации кода (геттеры, сеттеры и другие вспомогательные методы)
- **PostgreSQL** – основная база данных
- **MongoDB** – для хранения статистики
- **Kafka** – для обмена статистическими данными
- **MapStruct** – маппинг DTO
- **Docker** и **docker-compose** – для управления контейнерами

## Основные функции
1. **Управление отелями**:
    - CRUD-операции для сущности "Отель"
    - Поиск и фильтрация отелей по различным параметрам (город, рейтинг, расстояние от центра)
    - Поддержка пагинации

2. **Управление комнатами**:
    - CRUD-операции для сущности "Комната"
    - Фильтрация по параметрам (цена, количество гостей, доступные даты)
    - Пагинация и проверка доступности номеров на выбранные даты

3. **Пользователи**:
    - Регистрация и авторизация пользователей
    - Роли пользователей (пользователь и администратор) с разграничением доступа к функциям
    - Защита с использованием Spring Security и Basic Auth

4. **Бронирование**:
    - Создание бронирований с проверкой доступности комнат
    - Пагинированный вывод информации о бронях

5. **Статистика**:
    - Сбор данных о регистрации пользователей и бронировании комнат
    - Хранение статистики в MongoDB и экспорт данных в CSV-файл
    - Доступ к статистике ограничен ролью администратора

## Установка и запуск
1. **Клонирование репозитория**:
   ```bash
   git clone https://github.com/StepanShushakov/hotel-booking-service-backend.git
   cd hotel-booking-service 
 
2. **Запуск базы данных и приложения через Docker**:
- Убедитесь, что у вас установлен Docker и Docker Compose.
- Запустите необходимые сервисы, включая базы данных (PostgreSQL и MongoDB) и Kafka, с помощью скрипта:
   ```bash
   ./docker/docker-start.sh
 
3. **Запуск Spring Boot приложения**:
- После успешного запуска контейнеров, выполните команду для запуска приложения на Java:
   ```bash
   ./gradlew bootRun
Приложение будет доступно по адресу `http://localhost:8080`

## API-эндпоинты
### Отели
- `GET /hotels` - Получить список отелей с фильтрацией и пагинацией
- `POST /hotels` - Создать новый отель (доступно только для администратора)
- `PUT /hotels/{id}` - Редактировать отель (доступно только для администратора)
- `DELETE /hotels/{id}` - Удалить отель (доступно только для администратора)

### Комнаты
- `GET /rooms` - Получить список комнат с фильтрацией и пагинацией
- `POST /rooms` - Создать новую комнату (доступно только для администратора)
- `PUT /rooms/{id}` - Редактировать комнату (доступно только для администратора)
- `DELETE /rooms/{id}` - Удалить комнату (доступно только для администратора)

### Пользователи
- `POST /register` - Регистрация нового пользователя
- `GET /users/{username}` - Получить данные пользователя по имени пользователя

### Бронирование
- `POST /bookings` - Забронировать комнату
- `GET /bookings` - Получить список всех бронирований (доступно только для администратора)

### Статистика
- `GET /api/statistics/export` - Скачать CSV-файл с накопленными статистическими данными (доступно только для администратора)

## Безопасность
- Используется Basic Auth. Регистрация доступна без авторизации, все остальные действия требуют авторизации.
- Доступ к созданию, редактированию и удалению отелей и комнат ограничен для роли администратора.